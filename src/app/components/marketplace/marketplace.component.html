<h1>Marketplace {{waypoint?.symbol}}</h1>
<div class="text-container">
	<div *ngIf="waypoint != null">
		<div>
			<h2>Trade Goods</h2>
			<table>
				<tr>
					<th>Name</th>
					<th>Type</th>
					<th>Trade<br/>Volume</th>
					<th>Supply</th>
					<th>Purchase<br/>Price</th>
					<th>Sell<br/>	Price</th>
				</tr>
				<tr *ngFor="let tradeGood of goods"
				    [ngClass]="{ 'selected-row': tradeGood == selectedTradeItem }"
					(click)="selectTradeItem(tradeGood)">
					<td title="{{tradeGood.description}}">{{tradeGood.name}}</td>
					<td class="centered">{{tradeGood.type}}</td>
					<td class="numeric">{{tradeGood.purchasePrice == 0 ? '???' : tradeGood.tradeVolume}}</td>
					<td class="centered">{{tradeGood.purchasePrice == 0 ? '???' : tradeGood.supply}}</td>
					<td class="numeric">{{tradeGood.purchasePrice == 0 ? '???' : (tradeGood.purchasePrice | currency : 'USD' : 'symbol' : '1.0-0')}}</td>
					<td class="numeric">{{tradeGood.purchasePrice == 0 ? '???' : (tradeGood.sellPrice | currency : 'USD' : 'symbol' : '1.0-0')}}</td>
				</tr>
			</table>
			<div *ngIf="selectedTradeItem">
				Qty:<input type="number" [(ngModel)]="buyTradeQty">
				<button (click)="onBuyTradeItem()">buy</button>
			</div>
		</div>
		<div>
			<table>
				<tr>
					<td colspan="2">
						<h3>All markets with </h3>
					</td>
					<td colspan="4">
						<select [(ngModel)]="selectedItemSymbol" (ngModelChange)="updateOtherMarkets()">
							<option *ngFor="let tradeItem of tradeItems">{{tradeItem}}</option>
						</select>
					</td>
				</tr>
				<tr>
					<th>Market Symbol</th>
					<th>Distance</th>
					<th>Purchase Price</th>
					<th>Sell Price</th>
					<th>Trade Volume</th>
					<th>Supply</th>
				</tr>
				<tr *ngFor="let item of itemAtOtherMarkets">
					<td>{{item.marketSymbol}}</td>
					<td>{{getDistanceToMarket(item.marketSymbol)}}</td>
					<td>{{item.purchasePrice}}</td>
					<td>{{item.sellPrice}}</td>
					<td>{{item.tradeVolume}}</td>
					<td>{{item.supply}}</td>
				</tr>
			</table>
		</div>
	</div>
	
	<div>
		Credits: {{account?.credits | currency : 'USD' : 'symbol' : '1.0-0'}}<br/>
		Ships At Waypoint:
		<table *ngFor="let ship of shipsAtWaypoint"
			[ngClass]="{ 'selected-ship': ship == selectedShip }"
			(click)="onSelectShip(ship)">
			<tr>
				<th>{{ship.symbol}}</th>
				<td>
					<app-countdown [title]="'Cooldown'" *ngIf="ship.cooldown" [cooldown]="ship.cooldown"></app-countdown>
				</td>
				<td>
					<button *ngIf="ship.nav.status != 'DOCKED'"
					       (click)="onDockShip(ship)">Dock</button>
				</td>
			</tr>
			<tr>
				<th>Name</th>
				<th>Units</th>
			</tr>
			<tr *ngFor="let cargoItem of ship!.cargo.inventory"
			    [ngClass]="{ 'selected-cargo': cargoItem == selectedCargoItem }"
			    (click)="selectCargoItem(cargoItem)">
				<td title="{{cargoItem.description}}">{{ cargoItem.name}}</td>
				<td>{{cargoItem.units}}</td>
				<td><button (click)="onSellAll(cargoItem)">Sell All</button></td>
				<td><button (click)="onJettisonCargoItem(cargoItem)">Jettison</button></td>
			</tr>
			<tr>
				<td>Empty spaces</td>
				<td><b>{{ship.cargo.capacity - ship.cargo.units}}</b></td>
			</tr>
		</table>
		<div *ngIf="selectedCargoItem != null">
			<button (click)="onSellCargoItem()">Sell</button>
			Qty:<input type="number" [(ngModel)]="sellTradeQty">
		</div>
	</div>
</div>
